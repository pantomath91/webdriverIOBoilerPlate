!function(){"use strict";const e=Object.freeze({PROD:"https://api.netspend.com",PIT:"https://api-netspend-pit@.test.aus.netspend.net",TEST:"https://api-netspend-@.test.aus.netspend.net",CLOUDTEST:"https://api-netspend-cloud@.aws.netspend.net",LOCAL:"http://localhost:@",LOCALANDROID:"http://10.0.2.2:@",CERT:"https://api-netspend-01.cert.aus.netspend.net"}),t=Object.prototype.hasOwnProperty,n=n=>{if((e=>"string"==typeof e)(n)){const[s,o,r,...a]=n.split("-");if("NS"===s&&o&&r&&!a.length){const[n,a="",...d]=o.split(":");if(n&&!d.length){const o=n.toUpperCase();if((n=>t.call(e,n))(o)&&e[o].includes("@")===!!a){return{p:s,i:r,g:o,a:a||void 0,h:e[o].replace("@",a).toLowerCase()}}}}}return null},s=e=>{if(!window.webkit)return void console.error("could not find webkit message handlers",e);const t=Object.assign(e&&e.values||{},{message:e instanceof Error?e.message:"string"==typeof e?e:"unknown error"});window.webkit.messageHandlers.netspendSdkExec.postMessage({callbackId:"-1",plugin:"netspendSdk",method:"changeState",params:{status:"fatalError",data:t}})},o=()=>{};let r=!1;Promise.resolve().then(async()=>{if(r)throw new Error("netspend bridge already initialized");if(r=!0,!window.netspendInitConfig)throw new Error("expected netspend init config");if(!window.webkit)throw new Error("expected to run in webkit with native bridge");const e=(e=>{let t=0;const n=new Map;return{resolve({callbackId:e,result:t,value:s}){const o=n.get(e);if(o){const[r,a,d]=o;switch(t){case 0:return r(s);case 1:return a(s);case 2:return n.delete(e),d()}}},exec(s,r,a=null,d=o,i=o,p=o){const c=`${t++}`;n.set(c,[d,i,p]),e({callbackId:c,plugin:s,method:r,params:a})}}})(e=>{window.webkit.messageHandlers.netspendSdkExec.postMessage(e)});window.netspendExecResolve=e.resolve;const{sdkId:t,branding:a,theme:d}=window.netspendInitConfig,i=n(t);if(!i)throw new Error("invalid sdk id");if(await(e=>new Promise((t,n)=>{const s=document.createElement("script");s.src=e,s.onload=t,s.onerror=()=>n(new Error("failed to load netspend sdk")),document.body.appendChild(s)}))(`${i.h}/micro-apps/sdk.js`),!window.createNetspendSdk)throw new Error("failed to load netspend web sdk");const p=window.createNetspendSdk(t,d,a,"app",e.exec);e.exec("netspendSdk","getActivePurpose",null,t=>{if(!t)return;const{purposeToken:n,passcode:o,params:r={}}=t;p.openPurpose({purposeToken:n,passcode:o,params:r},{onEvent(t){e.exec("netspendSdk","sendEvent",{event:t.event,data:t.payload})},onStateChange(t){e.exec("netspendSdk","changeState",{status:t.event,data:t.payload})}}).catch(s)},()=>s("unexpected error listening for active purpose"))}).catch(s)}();
